---
import StampAvatar from '@components/ui/StampAvatar.astro';
import { t, type Locale } from '@/lib/i18n';

interface Props {
  locale?: Locale;
}

const { locale = 'en' } = Astro.props;
const currentYear = new Date().getFullYear();

// Get current path without locale prefix for language switcher
const currentPath = Astro.url.pathname.replace(/^\/(en|fr)/, '');
const alternatePath = currentPath || '/';

// Language switcher URLs
const enUrl = locale === 'en' ? null : `https://pierrickdeniel.com${alternatePath}`;
const frUrl = locale === 'fr' ? null : `https://pierrickdeniel.fr${alternatePath}`;
---

<footer class="py-16 mt-16 border-t border-[var(--color-border)]">
  <div class="max-w-[var(--width-content)] mx-auto px-[var(--spacing-page)]">
    <div class="flex flex-col sm:flex-row justify-between gap-12">
      <!-- Avatar + Copyright + Language Switch -->
      <div class="flex flex-col gap-6">
        <StampAvatar size="lg" />
        <div class="flex items-center gap-4">
          <p class="text-sm text-[var(--color-text-muted)]">Â© {currentYear} Pierrick Deniel</p>
          <div class="flex items-center gap-2 text-sm">
            {locale === 'en' ? (
              <span class="text-[var(--color-text)]">EN</span>
            ) : (
              <a href={enUrl} class="footer-link">EN</a>
            )}
            <span class="text-[var(--color-text-muted)]">/</span>
            {locale === 'fr' ? (
              <span class="text-[var(--color-text)]">FR</span>
            ) : (
              <a href={frUrl} class="footer-link">FR</a>
            )}
          </div>
        </div>
      </div>

      <!-- Links columns -->
      <div class="flex gap-16">
        <div class="flex flex-col gap-3">
          <a href={`/${locale}/now`} class="footer-link">{t(locale, 'now')}</a>
          <a href={`/${locale}/guestbook`} class="footer-link">{t(locale, 'guestbook')}</a>
          <a href={`/${locale}/colophon`} class="footer-link">{t(locale, 'colophon')}</a>
          <a href="/rss.xml" class="footer-link">{t(locale, 'rss')}</a>
        </div>
        <div class="flex flex-col gap-3">
          <a href="https://github.com/bKNNNNN" target="_blank" rel="noopener noreferrer" class="footer-link">GitHub</a>
          <a href="https://linkedin.com/in/pierrick-deniel" target="_blank" rel="noopener noreferrer" class="footer-link">LinkedIn</a>
          <a href="https://x.com/bKN____" target="_blank" rel="noopener noreferrer" class="footer-link">X</a>
        </div>
      </div>
    </div>
  </div>
</footer>

<style>
  .footer-link {
    color: var(--color-text-muted);
    text-decoration: none;
    transition: color 0.2s ease;
  }

  .footer-link:hover {
    color: var(--color-text);
  }
</style>
