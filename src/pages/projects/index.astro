---
import { getCollection } from 'astro:content';
import BaseLayout from '@layouts/BaseLayout.astro';

const projects = await getCollection('projects');
const sortedProjects = projects.sort((a, b) => b.data.year - a.data.year);
---

<BaseLayout title="Projects" description="My projects in SEO, automation and development">
  <main class="max-w-[var(--width-content)] mx-auto px-[var(--spacing-page)] py-16">
    <header class="mb-12">
      <h1>Projects</h1>
      <p class="text-[var(--color-text-muted)] mt-2">
        Side projects, open source, and consulting work.
      </p>
    </header>

    {sortedProjects.length === 0 ? (
      <p class="text-[var(--color-text-muted)]">
        No projects yet. Check back soon.
      </p>
    ) : (
      <div class="space-y-6">
        {sortedProjects.map((project) => (
          <a
            href={project.data.url || `/projects/${project.id}`}
            class="block group"
            target={project.data.url ? "_blank" : undefined}
            rel={project.data.url ? "noopener noreferrer" : undefined}
          >
            <div class="flex items-baseline justify-between gap-4">
              <span class="text-[var(--color-text)] group-hover:opacity-60">{project.data.title}</span>
              <span class="text-sm text-[var(--color-text-muted)] shrink-0">{project.data.year}</span>
            </div>
            <p class="text-sm text-[var(--color-text-muted)] mt-1">{project.data.description}</p>
          </a>
        ))}
      </div>
    )}
  </main>
</BaseLayout>
